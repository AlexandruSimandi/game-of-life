var UIModule=function(){function m(h){13==h.keyCode&&(0==gameModule.isRunning()?(document.getElementById("status").innerHTML="Game is running",document.getElementById("started").innerHTML="Press enter to pause",document.getElementById("Restart").innerHTML="Restart",gameModule.run()):(document.getElementById("status").innerHTML="Game is paused",document.getElementById("started").innerHTML="Press enter to resume",gameModule.pause()))}function e(h){var e,b=gameModule.getCanvas().getBoundingClientRect();
e=h.clientX-b.left;h=h.clientY-b.top;e=parseInt(e/gameModule.getCellDiameter());h=parseInt(h/gameModule.getCellDiameter());gameModule.drawCell(e,h)}return{initialize:function(){window.addEventListener("keydown",m,!1);document.getElementById("Acorn").addEventListener("mousedown",gameModule.makeAcorn,!1);document.getElementById("Walker").addEventListener("mousedown",gameModule.makeWalker,!1);document.getElementById("Gun").addEventListener("mousedown",gameModule.makeGun,!1);document.getElementById("Engine").addEventListener("mousedown",
gameModule.makeEngine,!1);document.getElementById("Restart").addEventListener("mousedown",gameModule.restart,!1);gameModule.getCanvas().addEventListener("mousedown",e,!1)},getContent:function(e){return document.getElementById(e)}}}(),gameModule=function(){function m(a,b,e,c){d.beginPath();d.fillStyle="#000000";d.rect(a,b,e,e);d.closePath();d.stroke();d.fillStyle=c?"green":"white";d.fill()}function e(a,b){a>=c&&(a=0);b>=c&&(b=0);0>a&&(a=c-1);0>b&&(b=c-1);return g[a][b]}function h(a,b){var c=0;e(a-
1,b-1)&&c++;e(a,b-1)&&c++;e(a+1,b-1)&&c++;e(a-1,b)&&c++;e(a+1,b)&&c++;e(a-1,b+1)&&c++;e(a,b+1)&&c++;e(a+1,b+1)&&c++;return c}function v(){for(var a=0;a<c;a++)for(var b=0;b<c;b++)n[a][b]&&m(a*f+1,b*f+1,f,g[a][b])}function b(a,b){g[a][b]=!0;m(a*f+1,b*f+1,f,g[a][b])}function r(){if(k){for(var a=[],b=0;b<c;b++){a[b]=[];for(var e,d=0;d<c;d++)e=h(b,d),a[b][d]=g[b][d]?2==e||3==e?!0:!1:3==e?!0:!1,n[b][d]=g[b][d]!=a[b][d]?!0:!1}g=a;v();setTimeout(function(){r()},1)}}var c,l,t,f,d,p,q,g,n,u=!1,k;return{initialize:function(){0==
u&&(u=!0,l=document.getElementById("main"),t=0,d=l.getContext("2d"),d.lineWidth=.5,p=l.width,q=l.height,g=[],n=[],k=!1)},run:function(){k=!0;r()},pause:function(){k=!1},restart:function(){k=!1;c=parseInt(UIModule.getContent("dimension").value);f=p/(c+t);for(var a=0;a<c;a++){g[a]=[];n[a]=[];for(var b=0;b<c;b++)g[a][b]=!1,n[a][b]=!1}d.clearRect(0,0,p,q);for(a=0;a<c;a++)d.beginPath(),d.moveTo(a*f+1,0),d.lineTo(a*f+1,q),d.stroke(),d.beginPath(),d.moveTo(0,a*f+1),d.lineTo(p,a*f+1),d.stroke()},isRunning:function(){return k},
makeAcorn:function(){var a=parseInt(c/2);b(a,a);b(a+1,a);b(a+1,a-1);b(a+2,a);b(a+2,a+1)},makeGun:function(){var a=parseInt(c/2);b(a-15,a+1);b(a-15,a+2);b(a-14,a+1);b(a-14,a+2);b(a-5,a+1);b(a-5,a+2);b(a-5,a+3);b(a-4,a+4);b(a-4,a);b(a-3,a+5);b(a-2,a+5);b(a-3,a-1);b(a-2,a-1);b(a-1,a+2);b(a+1,a+2);b(a+1,a+1);b(a+1,a+3);b(a+2,a+2);b(a,a);b(a,a+4);b(a+5,a);b(a+5,a-1);b(a+5,a+1);b(a+6,a);b(a+6,a-1);b(a+6,a+1);b(a+7,a+2);b(a+7,a-2);b(a+9,a-2);b(a+9,a-3);b(a+9,a-2);b(a+9,a-3);b(a+9,a+3);b(a+9,a+2);b(a+19,
a);b(a+19,a-1);b(a+20,a);b(a+20,a-1)},makeWalker:function(){var a=parseInt(c/2);b(a,a);b(a+1,a);b(a+1,a+1);b(a+2,a+1);b(a+2,a-1)},makeEngine:function(){var a=parseInt(c/2);b(a-20,a);b(a-19,a);b(a-18,a);b(a-17,a);b(a-16,a);b(a-15,a);b(a-14,a);b(a-13,a);b(a-11,a);b(a-10,a);b(a-9,a);b(a-8,a);b(a-7,a);b(a-3,a);b(a-2,a);b(a-1,a);b(a+6,a);b(a+7,a);b(a+8,a);b(a+9,a);b(a+10,a);b(a+11,a);b(a+12,a);b(a+14,a);b(a+15,a);b(a+16,a);b(a+17,a);b(a+18,a)},getCanvas:function(){return l},drawCell:function(a,b){g[a][b]=
g[a][b]?!1:!0;m(a*f+1,b*f+1,f,g[a][b])},getCanvas:function(){return l},getCellDiameter:function(){return f}}}();window.onload=function(){gameModule.initialize();gameModule.restart();UIModule.initialize()};
